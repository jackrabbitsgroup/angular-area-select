"use strict";angular.module("jackrabbitsgroup.angular-area-select",[]).directive("jrgAreaSelect",["$timeout",function($timeout){return{restrict:"A",transclude:!0,scope:{},template:function(element,attrs){var defaultsAttrs={};for(var xx in defaultsAttrs)void 0===attrs[xx]&&(attrs[xx]=defaultsAttrs[xx]);var html="<div><span ng-transclude></span><div>{{coords}}</div></div>";return html},link:function(){},controller:function($scope,$element){function init(){getEleCoords({})}function start(evt){var xx=evt.pageX,yy=evt.pageY;console.log("starting"),$scope.coords.start.x=xx,$scope.coords.start.y=yy,$scope.state.started=!0,$scope.state.ended=!1}function end(evt){if($scope.state.started){console.log("ending");var xx=evt.pageX;xx>$scope.coords.ele.x2?xx=$scope.coords.ele.x2:xx<$scope.coords.ele.x1&&(xx=$scope.coords.ele.x1);var yy=evt.pageY;yy>$scope.coords.ele.y2?yy=$scope.coords.ele.y2:yy<$scope.coords.ele.y1&&(yy=$scope.coords.ele.y1),$scope.coords.end.x=xx,$scope.coords.end.y=yy,$scope.state.ended=!0}$scope.state.started=!1}function scopeApply(){$scope.$$phase||$scope.$apply()}function getEleCoords(){$timeout(function(){var rect=eles.main[0].getBoundingClientRect();$scope.coords.ele={x1:rect.left,x2:rect.right,y1:rect.top,y2:rect.bottom}},100)}var eles={main:$element.find("span"),doc:angular.element(document)};$scope.state={started:!1,ended:!1},$scope.coords={ele:{x1:0,x2:0,y1:0,y2:0},select:{x1:0,x2:0,y1:0,y2:0},start:{x:0,y:0},end:{x:0,y:0}},eles.doc.on("mousedown",function(evt){console.log("mousedown"),start(evt,{}),scopeApply({})}),eles.doc.on("touchstart",function(evt){console.log("touchstart"),start(evt,{}),scopeApply({})}),eles.doc.on("mouseup",function(evt){console.log("mouseup"),end(evt,{}),scopeApply({})}),eles.doc.on("touchend",function(evt){console.log("touchend"),end(evt,{}),scopeApply({})}),eles.doc.on("mousemove",function(){console.log("mousemove"),scopeApply({})}),eles.doc.on("touchmove",function(){console.log("touchmove"),scopeApply({})}),init({})}}}]);